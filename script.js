// ================================
// TRADUCTIONS
// ================================

const translations = {
    fr: {
        site_name: "Physique Tech",
        nav_home: "Accueil",
        nav_about: "√Ä propos",
        nav_team: "√âquipe",
        nav_activities: "Activit√©s",
        nav_contact: "Contact",
        login_btn: "Connexion",
        hero_title: "Bienvenue au Club Physique Tech",
        hero_description: "Explorez les merveilles de la physique et de la technologie avec une communaut√© passionn√©e d'√©tudiants et de chercheurs.",
        hero_cta: "D√©couvrir notre club",
        about_title: "√Ä propos de nous",
        mission_title: "Notre Mission",
        mission_text: "Promouvoir l'apprentissage et la d√©couverte dans les domaines de la physique et de la technologie √† travers des activit√©s pratiques, des conf√©rences et des projets collaboratifs.",
        vision_title: "Notre Vision",
        vision_text: "Devenir le club de r√©f√©rence pour tous les passionn√©s de sciences physiques et technologiques, en cr√©ant un environnement d'apprentissage stimulant et innovant.",
        values_title: "Nos Valeurs",
        values_text: "Excellence acad√©mique, collaboration, innovation, curiosit√© scientifique et partage des connaissances sont au c≈ìur de notre d√©marche √©ducative.",
        team_title: "Notre √âquipe",
        member1_name: "Dr. Ahmed Benali",
        member1_role: "Pr√©sident",
        member1_bio: "Docteur en Physique Quantique, passionn√© par la recherche en nanotechnologies et l'enseignement scientifique.",
        member2_name: "Fatima Zahra",
        member2_role: "Vice-Pr√©sidente",
        member2_bio: "Ing√©nieure en √©lectronique, sp√©cialis√©e dans les syst√®mes embarqu√©s et l'intelligence artificielle.",
        member3_name: "Omar Taha",
        member3_role: "Secr√©taire G√©n√©ral",
        member3_bio: "√âtudiant en Master Physique Appliqu√©e, responsable de l'organisation des √©v√©nements et des activit√©s du club.",
        member4_name: "Aicha Mansouri",
        member4_role: "Responsable Communication",
        member4_bio: "Doctorante en Physique des Mat√©riaux, g√®re la communication et les relations ext√©rieures du club.",
        activities_title: "Nos Activit√©s",
        activity1_title: "üî¨ Ateliers Pratiques",
        activity1_desc: "Des s√©ances de travaux pratiques hebdomadaires sur diverses th√©matiques : optique, √©lectronique, m√©canique quantique, et plus encore.",
        activity1_when: "Tous les mercredis 14h-17h",
        activity2_title: "üìö Conf√©rences",
        activity2_desc: "Conf√©rences mensuelles anim√©es par des experts du domaine, abordant les derni√®res avanc√©es en physique et technologie.",
        activity2_when: "Premier vendredi de chaque mois 18h-20h",
        activity3_title: "üèÜ Comp√©titions",
        activity3_desc: "Participation aux olympiades de physique, concours de robotique et d√©fis technologiques nationaux et internationaux.",
        activity3_when: "Selon le calendrier des comp√©titions",
        activity4_title: "üîß Projets de Recherche",
        activity4_desc: "D√©veloppement de projets de recherche collaboratifs entre √©tudiants et encadrement par des professeurs.",
        activity4_when: "Projets semestriels et annuels",
        when_label: "Quand :",
        contact_title: "Contactez-nous",
        address_title: "Adresse",
        address_text: "Facult√© des Sciences Appliqu√©es Nador<br>Universit√© Mohammed Premier Oujda <br>Nador, Maroc",
        email_title: "Email",
        phone_title: "T√©l√©phone",
        phone_hours: "Lun-Ven: 9h-17h",
        login_title: "Connexion",
        email_label: "Email:",
        password_label: "Mot de passe:",
        login_submit: "Se connecter",
        not_member: "Pas encore membre?",
        create_account: "Cr√©er un compte",
        signup_title: "Cr√©er un compte",
        firstname_label: "Pr√©nom:",
        lastname_label: "Nom:",
        apogee_label: "Num√©ro d'Apog√©e:",
        cycle_label: "Cycle d'√©tude:",
        select_cycle: "S√©lectionnez votre cycle",
        licence_option: "Licence",
        master_option: "Master",
        specialization_label: "Sp√©cialisation:",
        signup_submit: "Cr√©er le compte",
        already_member: "D√©j√† membre?",
        login_link: "Se connecter"
    },
    en: {
        site_name: "Physics Tech",
        nav_home: "Home",
        nav_about: "About",
        nav_team: "Team",
        nav_activities: "Activities",
        nav_contact: "Contact",
        login_btn: "Login",
        hero_title: "Welcome to Physics Tech Club",
        hero_description: "Explore the wonders of physics and technology with a passionate community of students and researchers.",
        hero_cta: "Discover our club",
        about_title: "About Us",
        mission_title: "Our Mission",
        mission_text: "Promote learning and discovery in physics and technology through hands-on activities, conferences, and collaborative projects.",
        vision_title: "Our Vision",
        vision_text: "Become the reference club for all physics and technology enthusiasts, creating a stimulating and innovative learning environment.",
        values_title: "Our Values",
        values_text: "Academic excellence, collaboration, innovation, scientific curiosity, and knowledge sharing are at the heart of our educational approach.",
        team_title: "Our Team",
        member1_name: "Dr. Ahmed Benali",
        member1_role: "President",
        member1_bio: "PhD in Quantum Physics, passionate about nanotechnology research and scientific education.",
        member2_name: "Fatima Zahra",
        member2_role: "Vice President",
        member2_bio: "Electronics engineer, specialized in embedded systems and artificial intelligence.",
        member3_name: "Omar Taha",
        member3_role: "General Secretary",
        member3_bio: "Master's student in Applied Physics, responsible for organizing club events and activities.",
        member4_name: "Aicha Mansouri",
        member4_role: "Communication Manager",
        member4_bio: "PhD student in Materials Physics, manages club communication and external relations.",
        activities_title: "Our Activities",
        activity1_title: "üî¨ Practical Workshops",
        activity1_desc: "Weekly practical sessions on various topics: optics, electronics, quantum mechanics, and more.",
        activity1_when: "Every Wednesday 2pm-5pm",
        activity2_title: "üìö Conferences",
        activity2_desc: "Monthly conferences led by field experts, covering the latest advances in physics and technology.",
        activity2_when: "First Friday of each month 6pm-8pm",
        activity3_title: "üèÜ Competitions",
        activity3_desc: "Participation in physics olympiads, robotics contests, and national and international technology challenges.",
        activity3_when: "According to competition calendar",
        activity4_title: "üîß Research Projects",
        activity4_desc: "Development of collaborative research projects between students and supervision by professors.",
        activity4_when: "Semester and annual projects",
        when_label: "When:",
        contact_title: "Contact Us",
        address_title: "Address",
        address_text: "Faculty of Applied Sciences Nador<br>Mohammed Premier University Oujda<br>Nador, Morocco",
        email_title: "Email",
        phone_title: "Phone",
        phone_hours: "Mon-Fri: 9am-5pm",
        login_title: "Login",
        email_label: "Email:",
        password_label: "Password:",
        login_submit: "Sign In",
        not_member: "Not a member yet?",
        create_account: "Create an account",
        signup_title: "Create an Account",
        firstname_label: "First Name:",
        lastname_label: "Last Name:",
        apogee_label: "Apogee Number:",
        cycle_label: "Study Cycle:",
        select_cycle: "Select your cycle",
        licence_option: "Bachelor",
        master_option: "Master",
        specialization_label: "Specialization:",
        signup_submit: "Create Account",
        already_member: "Already a member?",
        login_link: "Sign In"
    },

    es: {
        site_name: "F√≠sica Tech",
        nav_home: "Inicio",
        nav_about: "Acerca de",
        nav_team: "Equipo",
        nav_activities: "Actividades",
        nav_contact: "Contacto",
        login_btn: "Iniciar Sesi√≥n",
        hero_title: "Bienvenidos al Club F√≠sica Tech",
        hero_description: "Exploren las maravillas de la f√≠sica y la tecnolog√≠a con una comunidad entusiasta de estudiantes e investigadores.",
        hero_cta: "Descubre nuestro club",
        about_title: "Acerca de nosotros",
        mission_title: "Nuestra Misi√≥n",
        mission_text: "Fomentar el aprendizaje y el descubrimiento en los campos de la f√≠sica y la tecnolog√≠a a trav√©s de actividades pr√°cticas, conferencias y proyectos colaborativos.",
        vision_title: "Nuestra Visi√≥n",
        vision_text: "Convertirnos en el club de referencia para todos los interesados en las ciencias f√≠sicas y tecnol√≥gicas, creando un entorno educativo estimulante e innovador.",
        values_title: "Nuestros Valores",
        values_text: "La excelencia acad√©mica, la colaboraci√≥n, la innovaci√≥n, la curiosidad cient√≠fica y el intercambio de conocimientos est√°n en el coraz√≥n de nuestro enfoque educativo.",
        team_title: "Nuestro Equipo",
        member1_name: "Dr. Ahmed Ben Ali",
        member1_role: "Presidente",
        member1_bio: "Doctorado en F√≠sica Cu√°ntica, apasionado por la investigaci√≥n en nanotecnolog√≠a y educaci√≥n cient√≠fica.",
        member2_name: "Fatima Zahra",
        member2_role: "Vicepresidenta",
        member2_bio: "Ingeniera en Electr√≥nica, especializada en sistemas embebidos e inteligencia artificial.",
        member3_name: "Omar Taha",
        member3_role: "Secretario General",
        member3_bio: "Estudiante de maestr√≠a en F√≠sica Aplicada, responsable de organizar eventos y actividades del club.",
        member4_name: "Aicha Mansouri",
        member4_role: "Responsable de Comunicaci√≥n",
        member4_bio: "Estudiante de doctorado en F√≠sica de Materiales, gestiona la comunicaci√≥n y relaciones externas del club.",
        activities_title: "Nuestras Actividades",
        activity1_title: "üî¨ Talleres Pr√°cticos",
        activity1_desc: "Sesiones pr√°cticas semanales sobre temas diversos: √≥ptica, electr√≥nica, mec√°nica cu√°ntica y m√°s.",
        activity1_when: "Todos los mi√©rcoles 14:00-17:00",
        activity2_title: "üìö Conferencias",
        activity2_desc: "Conferencias mensuales impartidas por expertos en el campo, abordando los √∫ltimos avances en f√≠sica y tecnolog√≠a.",
        activity2_when: "Primer viernes de cada mes 18:00-20:00",
        activity3_title: "üèÜ Competencias",
        activity3_desc: "Participaci√≥n en olimpiadas de f√≠sica, competencias de rob√≥tica y desaf√≠os tecnol√≥gicos nacionales e internacionales.",
        activity3_when: "Seg√∫n calendario de competencias",
        activity4_title: "üîß Proyectos de Investigaci√≥n",
        activity4_desc: "Desarrollo de proyectos de investigaci√≥n colaborativos entre estudiantes con supervisi√≥n de profesores.",
        activity4_when: "Proyectos semestrales y anuales",
        when_label: "Cu√°ndo:",
        contact_title: "Cont√°ctanos",
        address_title: "Direcci√≥n",
        address_text: "Facultad de Ciencias Aplicadas Nador<br>Universidad Mohammed I Oujda<br>Nador, Marruecos",
        email_title: "Correo Electr√≥nico",
        phone_title: "Tel√©fono",
        phone_hours: "Lunes-Viernes: 9am-5pm",
        login_title: "Iniciar Sesi√≥n",
        email_label: "Correo Electr√≥nico:",
        password_label: "Contrase√±a:",
        login_submit: "Entrar",
        not_member: "¬øA√∫n no eres miembro?",
        create_account: "Crear cuenta",
        signup_title: "Crear Cuenta",
        firstname_label: "Nombre:",
        lastname_label: "Apellido:",
        apogee_label: "N√∫mero Apogeo:",
        cycle_label: "Ciclo de Estudios:",
        select_cycle: "Selecciona tu ciclo",
        licence_option: "Licenciatura",
        master_option: "Maestr√≠a",
        specialization_label: "Especializaci√≥n:",
        signup_submit: "Crear Cuenta",
        already_member: "¬øYa eres miembro?",
        login_link: "Iniciar Sesi√≥n"
    }
};

let currentLanguage = 'fr';

//==================================
// Fonction pour g√©rer la connexion
//==================================

function handleLogin(event) {
    event.preventDefault();
    console.log("handleLogin ex√©cut√©e");

    const formData = new FormData(event.target);
    const email = formData.get('email');
    const password = formData.get('password');

    const validUsers = [
        { email: 'jalalelyandouzi2@gmail.com', password: 'Elynd@12' },
        { email: 'ahmed.benali@gmail.com', password: 'Physics2024!' },
        { email: 'fatima.zahra@gmail.com', password: 'TechClub@23' },
        { email: 'omar.taha@gmail.com', password: 'Science@456' }
    ];

    const user = validUsers.find(u => u.email === email && u.password === password);

    if (user) {
        // Connexion r√©ussie
        closeModal();
        showLoginSuccess();
    } else {
        // Erreur de connexion - fermer le modal de connexion et afficher l'erreur
        document.getElementById('loginModal').style.display = 'none';
        showLoginError();
    }
}

//==============================================
// Fonction pour afficher le succ√®s de connexion
//==============================================

function showLoginSuccess() {
    document.getElementById('loginSuccessModal').style.display = 'block';
    
    // Redirection vers Facebook apr√®s 3 secondes
    setTimeout(() => {
        window.location.href = 'https://facebook.com';
    }, 3000);
}

//=============================================
// Fonction pour afficher l'erreur de connexion
//=============================================

function showLoginError() {
    document.getElementById('loginErrorModal').style.display = 'block';
}

//=============================================
// Fonction pour toggle menu
//=============================================
document.addEventListener("DOMContentLoaded", () => {
    const menuToggle = document.getElementById("menu-toggle");
    const navLinks = document.getElementById("nav-links");

    menuToggle.addEventListener("click", () => {
        navLinks.classList.toggle("active");
        menuToggle.classList.toggle("active");
    });
});

function closeMenu() {
    document.getElementById("nav-links").classList.remove("active");
    document.getElementById("menu-toggle").classList.remove("active");
}

//=============================================
// Fonction pour r√©essayer la connexion
//=============================================

function retryLogin() {
    // Fermer le modal d'erreur
    document.getElementById('loginErrorModal').style.display = 'none';
    
    // Rouvrir le modal de connexion
    document.getElementById('loginModal').style.display = 'block';
    
    // Optionnel : vider les champs du formulaire
    document.getElementById('email').value = '';
    document.getElementById('password').value = '';
    
    // Optionnel : mettre le focus sur le champ email
    document.getElementById('email').focus();
}

// Fonction pour ouvrir le modal
function openModal() {
    document.getElementById('loginModal').style.display = 'block';
}

function closeModal() {
    // Fermer tous les modals
    const modals = document.querySelectorAll('.modal');
    modals.forEach(modal => {
        modal.style.display = 'none';
    });
}

// Fonction pour afficher le modal d'inscription
function showSignupModal() {
    closeModal();
    document.getElementById('signupModal').style.display = 'block';
}

// Fonction pour afficher le modal de connexion
function showLoginModal() {
    closeModal();
    document.getElementById('loginModal').style.display = 'block';
}

// Fonction pour g√©rer les sp√©cialisations
function toggleSpecialization() {
    const cycle = document.getElementById('cycle').value;
    const licenceOptions = document.getElementById('licenceOptions');
    
    if (cycle === 'licence') {
        licenceOptions.style.display = 'block';
        // Rendre la sp√©cialisation obligatoire pour licence
        const radioButtons = licenceOptions.querySelectorAll('input[type="radio"]');
        radioButtons.forEach(radio => {
            radio.required = true;
        });
    } else {
        licenceOptions.style.display = 'none';
        // Retirer l'obligation pour les autres cycles
        const radioButtons = licenceOptions.querySelectorAll('input[type="radio"]');
        radioButtons.forEach(radio => {
            radio.required = false;
            radio.checked = false;
        });
    }
}

// ================================
// FONCTIONS DE NAVIGATION
// ================================

function showSection(sectionName) {
    // Masquer toutes les sections
    const sections = document.querySelectorAll('.section');
    sections.forEach(section => {
        section.classList.remove('active');
    });
    
    // Masquer la section hero si on navigue vers une autre section
    const hero = document.getElementById('home');
    if (sectionName !== 'home') {
        hero.style.display = 'none';
    } else {
        hero.style.display = 'block';
    }
    
    // Afficher la section demand√©e
    if (sectionName !== 'home') {
        const targetSection = document.getElementById(sectionName);
        if (targetSection) {
            targetSection.classList.add('active');
        }
    }
    
    // Fermer les modals si ouverts
    closeModal();
}

// ================================
// FONCTIONS DE TRADUCTION
// ================================

function changeLanguage(lang) {
    currentLanguage = lang;
    
    // Mettre √† jour les boutons de langue
    const langBtns = document.querySelectorAll('.lang-btn');
    langBtns.forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // Appliquer les traductions
    const elementsToTranslate = document.querySelectorAll('[data-translate]');
    elementsToTranslate.forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[lang] && translations[lang][key]) {
            if (element.innerHTML.includes('<br>')) {
                element.innerHTML = translations[lang][key];
            } else {
                element.textContent = translations[lang][key];
            }
        }
    });
}

// ================================
// FONCTIONS MODALS SUPPL√âMENTAIRES
// ================================

function showSuccessModal() {
    document.getElementById('signupModal').style.display = 'none';
    document.getElementById('loginModal').style.display = 'none';
    document.getElementById('successModal').style.display = 'block';
}

// ================================
// GESTION DES FORMULAIRES
// ================================

function handleSignup(event) {
    event.preventDefault();
    
    const submitButton = event.target.querySelector('.form-submit');
    const originalText = submitButton.textContent;
    
    // D√©sactiver le bouton et afficher le loading
    submitButton.disabled = true;
    submitButton.classList.add('loading');
    
    const formData = new FormData(event.target);
    const userData = {
        firstName: formData.get('firstName'),
        lastName: formData.get('lastName'),
        apogeeNumber: formData.get('apogeeNumber'),
        email: formData.get('email'),
        password: formData.get('password'),
        cycle: formData.get('cycle'),
        specialization: formData.get('specialization')
    };
    
    // Validation des donn√©es
    if (!userData.firstName || !userData.lastName || !userData.email || !userData.password) {
        alert('Veuillez remplir tous les champs obligatoires');
        submitButton.disabled = false;
        submitButton.classList.remove('loading');
        return;
    }
    
    if (userData.cycle === 'licence' && !userData.specialization) {
        alert('Veuillez s√©lectionner une sp√©cialisation pour le cycle Licence');
        submitButton.disabled = false;
        submitButton.classList.remove('loading');
        return;
    }
    
    // Simuler l'envoi des donn√©es
    setTimeout(function() {
        console.log('Donn√©es d\'inscription:', userData);
        
        // R√©activer le bouton
        submitButton.disabled = false;
        submitButton.classList.remove('loading');
        
        // Afficher le modal de succ√®s
        showSuccessModal();
        
        // Rediriger vers la page "√Ä propos" apr√®s 3 secondes
        setTimeout(function() {
            closeModal();
            showSection('about');
        }, 3000);
        
    }, 2000); // Simulation d'un d√©lai d'envoi
}

// ================================
// √âV√âNEMENTS
// ================================

// Fermer les modals en cliquant √† l'ext√©rieur
window.onclick = function(event) {
    const loginModal = document.getElementById('loginModal');
    const signupModal = document.getElementById('signupModal');
    const successModal = document.getElementById('successModal');
    const loginSuccessModal = document.getElementById('loginSuccessModal');
    const loginErrorModal = document.getElementById('loginErrorModal');
    
    if (event.target === loginModal) {
        loginModal.style.display = 'none';
    }
    if (event.target === signupModal) {
        signupModal.style.display = 'none';
    }
    if (event.target === successModal) {
        successModal.style.display = 'none';
    }
    if (event.target === loginSuccessModal) {
        loginSuccessModal.style.display = 'none';
    }
    if (event.target === loginErrorModal) {
        loginErrorModal.style.display = 'none';
    }
}

// Fermer les modals avec la touche √âchap
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        closeModal();
    }
});

// ================================
// INITIALISATION
// ================================

document.addEventListener('DOMContentLoaded', function() {
    // Afficher la section d'accueil par d√©faut
    showSection('home');
    
    // Appliquer la traduction fran√ßaise par d√©faut
    changeLanguage('fr');
    
    console.log('Site Physique Tech initialis√© avec succ√®s!');
});

// Fonction pour ouvrir la modal de connexion
function openModal() {
    document.getElementById('loginModal').style.display = 'flex';
}

// Fonction pour fermer toutes les modals
function closeModal() {
    document.getElementById('loginModal').style.display = 'none';
    document.getElementById('signupModal').style.display = 'none';
    document.getElementById('successModal').style.display = 'none';
    document.getElementById('loginSuccessModal').style.display = 'none';
    document.getElementById('loginErrorModal').style.display = 'none';
}

// Fonction pour afficher la modal d'inscription
function showSignupModal() {
    document.getElementById('loginModal').style.display = 'none';
    document.getElementById('signupModal').style.display = 'flex';
}

// Fonction pour afficher la modal de connexion
function showLoginModal() {
    document.getElementById('signupModal').style.display = 'none';
    document.getElementById('loginModal').style.display = 'flex';
}

// Fonction pour basculer les options de sp√©cialisation
function toggleSpecialization() {
    const cycle = document.getElementById('cycle').value;
    const licenceOptions = document.getElementById('licenceOptions');
    
    if (cycle === 'licence') {
        licenceOptions.style.display = 'block';
        // Rendre les boutons radio requis si licence est s√©lectionn√©e
        const radioButtons = licenceOptions.querySelectorAll('input[type="radio"]');
        radioButtons.forEach(radio => radio.required = true);
    } else {
        licenceOptions.style.display = 'none';
        // Retirer l'exigence et d√©cocher les boutons radio
        const radioButtons = licenceOptions.querySelectorAll('input[type="radio"]');
        radioButtons.forEach(radio => {
            radio.required = false;
            radio.checked = false;
        });
    }
}

// Gestion de la soumission du formulaire d'inscription
document.addEventListener('DOMContentLoaded', function() {
    const signupForm = document.getElementById('signupForm');
    
    if (signupForm) {
        signupForm.addEventListener('submit', function(e) {
            // V√©rifier si une sp√©cialisation est s√©lectionn√©e pour licence
            const cycle = document.getElementById('cycle').value;
            if (cycle === 'licence') {
                const specialisation = document.querySelector('input[name="Sp√©cialisation"]:checked');
                if (!specialisation) {
                    e.preventDefault();
                    alert('Veuillez s√©lectionner une sp√©cialisation pour le cycle Licence.');
                    return;
                }
            }
            
            // Fermer la modal d'inscription avant la soumission
            document.getElementById('signupModal').style.display = 'none';
            
            // Afficher la modal de succ√®s
            document.getElementById('successModal').style.display = 'flex';
            
            // Optionnel : redirection apr√®s 3 secondes
            setTimeout(function() {
                // Le formulaire sera soumis automatiquement gr√¢ce √† FormSubmit
                // La redirection se fera via le champ _next de FormSubmit
            }, 3000);
        });
    }
});

// Fonction pour r√©essayer la connexion
function retryLogin() {
    document.getElementById('loginErrorModal').style.display = 'none';
    document.getElementById('loginModal').style.display = 'flex';
}

// Fermer les modals en cliquant √† l'ext√©rieur
window.onclick = function(event) {
    const modals = ['loginModal', 'signupModal', 'successModal', 'loginSuccessModal', 'loginErrorModal'];
    modals.forEach(modalId => {
        const modal = document.getElementById(modalId);
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    });
}

// Fonctions de navigation (si vous en avez besoin)
function showSection(sectionId) {
    // Masquer toutes les sections
    const sections = document.querySelectorAll('.section, .hero');
    sections.forEach(section => {
        section.style.display = 'none';
    });
    
    // Afficher la section demand√©e
    const targetSection = document.getElementById(sectionId);
    if (targetSection) {
        targetSection.style.display = 'block';
    }
}

// Initialiser l'affichage de la page d'accueil
document.addEventListener('DOMContentLoaded', function() {
    showSection('home');
});
